# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç - RunPod ComfyUI Universal

## –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Docker –æ–±—Ä–∞–∑ –¥–ª—è RunPod —Å PyTorch 2.8.0

### ‚ö° –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

-   **PyTorch 2.8.0** + **CUDA 12.8.1** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
-   **–î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã** - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–ª–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
-   **–ë—ã—Å—Ç—Ä–æ–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - symlinks –≤–º–µ—Å—Ç–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è (1-3 —Å–µ–∫ vs 30-120 —Å–µ–∫)
-   **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ –≤—Å–µ–º–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ workflow

---

## üõ†Ô∏è –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞

```bash
git clone <your-repo>
cd runpodComfyUniversal
docker build -t runpod-comfy-universal:latest .
```

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

```bash
./test-build-new.sh
```

---

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ù–∞ RunPod Platform

1. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ –æ–±—Ä–∞–∑** –≤ RunPod Registry –∏–ª–∏ Docker Hub
2. **–°–æ–∑–¥–∞–π—Ç–µ Serverless Endpoint:**
    - Image: `your-registry/runpod-comfy-universal:latest`
    - Volume: –ø–æ–¥–∫–ª—é—á–∏—Ç–µ Network Volume —Å –º–æ–¥–µ–ª—è–º–∏
3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ** - —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–µ—Ä–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –° GPU
docker run --rm --gpus all -p 8188:8188 \
  -v $(pwd)/test-volume:/runpod-volume \
  runpod-comfy-universal:latest

# –¢–æ–ª—å–∫–æ CPU (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
docker run --rm -p 8188:8188 \
  -v $(pwd)/test-volume:/runpod-volume \
  runpod-comfy-universal:latest
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ RunPod Volume

### –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```
/runpod-volume/ComfyUI/
‚îú‚îÄ‚îÄ main.py                 # (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –í–∞—à–∞ –≤–µ—Ä—Å–∏—è ComfyUI
‚îú‚îÄ‚îÄ models/                 # üéØ –í–∞—à–∏ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ checkpoints/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sd_xl_base_1.0.safetensors
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ loras/
‚îÇ   ‚îú‚îÄ‚îÄ vae/
‚îÇ   ‚îî‚îÄ‚îÄ controlnet/
‚îú‚îÄ‚îÄ custom_nodes/          # üîß –í–∞—à–∏ –∫–∞—Å—Ç–æ–º –Ω–æ–¥—ã
‚îÇ   ‚îú‚îÄ‚îÄ ComfyUI-Manager/
‚îÇ   ‚îú‚îÄ‚îÄ ComfyUI-Impact-Pack/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ input/                 # üì• –í—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ output/                # üì§ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
‚îî‚îÄ‚îÄ user/                  # ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏
```

---

## üîÑ –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

### üöÄ Volume-First Mode (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ö–æ–≥–¥–∞ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è:** –ï—Å—Ç—å `/runpod-volume/ComfyUI/main.py`

‚úÖ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

-   –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç (<1 —Å–µ–∫)
-   –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
-   –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
-   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–∞—à–∞ –≤–µ—Ä—Å–∏—è ComfyUI

‚öôÔ∏è **–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:**

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ComfyUI –Ω–∞ volume
2. –î–æ–±–∞–≤—å—Ç–µ –º–æ–¥–µ–ª–∏ –∏ –∫–∞—Å—Ç–æ–º –Ω–æ–¥—ã
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ - —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–µ—Ä–µ—Ç —ç—Ç–æ—Ç —Ä–µ–∂–∏–º

### üîß Hybrid Mode (–°—Ç–∞–±–∏–ª—å–Ω—ã–π)

**–ö–æ–≥–¥–∞ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è:** –ù–ï–¢ `/runpod-volume/ComfyUI/main.py`

‚úÖ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

-   –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ –æ–±—Ä–∞–∑–∞
-   –ë—ã—Å—Ç—Ä–æ–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (1-3 —Å–µ–∫)
-   –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞
-   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

‚öôÔ∏è **–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:**

1. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫–∏ –º–æ–¥–µ–ª–µ–π –∏ –∫–∞—Å—Ç–æ–º –Ω–æ–¥–æ–≤ –Ω–∞ volume
2. –ù–ï –∫–æ–ø–∏—Ä—É–π—Ç–µ main.py
3. –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π ComfyUI + –≤–∞—à–∏ —Ä–µ—Å—É—Ä—Å—ã

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã

```bash
# –í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –∏–ª–∏ –ª–æ–≥–∞—Ö
echo "Current mode: $APP"
# /runpod-volume/ComfyUI = Volume-First
# /workspace/ComfyUI = Hybrid
```

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥—É–ª–µ–π Python
./debug-modules.sh

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
ls -la /workspace/ComfyUI/models/
ls -la /workspace/ComfyUI/custom_nodes/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö
du -sh /workspace/ComfyUI/* 2>/dev/null
du -sh /runpod-volume/ComfyUI/* 2>/dev/null
```

### –õ–æ–≥–∏ –∑–∞–ø—É—Å–∫–∞

–°–ª–µ–¥–∏—Ç–µ –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:

-   `‚úÖ ComfyUI –Ω–∞–π–¥–µ–Ω –Ω–∞ volume` = Volume-First Mode
-   `üì¶ –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π ComfyUI` = Hybrid Mode
-   `‚úÖ –ú–æ–¥–µ–ª–∏ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã` = –£—Å–ø–µ—à–Ω–æ–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –û–ø–µ—Ä–∞—Ü–∏—è      | –°—Ç–∞—Ä—ã–π rsync   | –ù–æ–≤—ã–π symlink | Volume-First   |
| ------------- | -------------- | ------------- | -------------- |
| **–°—Ç–∞—Ä—Ç**     | 30-120 —Å–µ–∫     | 1-3 —Å–µ–∫       | <1 —Å–µ–∫         |
| **–ú–µ—Å—Ç–æ**     | +2-10 GB       | +500 MB       | 0 –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è |
| **–ò–∑–º–µ–Ω–µ–Ω–∏—è** | –ù–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è | –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è   | –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è    |

---

## ‚ö†Ô∏è Troubleshooting

### ComfyUI –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—É—Ç—å
ls -la /workspace/ComfyUI/main.py
ls -la /runpod-volume/ComfyUI/main.py

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
cd /workspace/ComfyUI && python -c "import torch; print(torch.__version__)"
```

### –ú–æ–¥–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º symlink
ls -la /workspace/ComfyUI/models
readlink /workspace/ComfyUI/models

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
find /workspace/ComfyUI/models -name "*.safetensors" | head -5
```

### –ö–∞—Å—Ç–æ–º –Ω–æ–¥—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º symlink
ls -la /workspace/ComfyUI/custom_nodes
cd /workspace/ComfyUI && python -c "import sys; sys.path.append('custom_nodes'); import ComfyUI-Manager"
```

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

-   [üìö –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](docs/new-pytorch-upgrade.md)
-   [üîß –°—Ç—Ä–∞—Ç–µ–≥–∏—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](docs/volume-mounting-strategy.md)
-   [üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏](docs/build-fixes.md)
-   [üìñ –û—Å–Ω–æ–≤–Ω–æ–π README](docs/readme.md)

---

## üí° –°–æ–≤–µ—Ç—ã –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Volume-First Mode** - —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ ComfyUI –Ω–∞ volume
2. **NVMe Volume** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±—ã—Å—Ç—Ä—ã–µ –¥–∏—Å–∫–∏ –≤ RunPod
3. **–ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞** - –¥–µ—Ä–∂–∏—Ç–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–æ–¥–µ–ª–∏ –Ω–∞ volume

### –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Hybrid Mode** - –Ω–µ –∫–æ–ø–∏—Ä—É–π—Ç–µ main.py –Ω–∞ volume
2. **–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏** - —Ä–µ–≥—É–ª—è—Ä–Ω–æ –±—ç–∫–∞–ø—å—Ç–µ volume
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∫–∞—Å—Ç–æ–º –Ω–æ–¥—ã –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

1. **Volume-First** –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∏—Ç–µ—Ä–∞—Ü–∏–π
2. **–õ–æ–∫–∞–ª—å–Ω–æ–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–¥–æ–≤
3. **debug-modules.sh** –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º
